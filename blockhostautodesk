Clear-Host
# Ensure the script runs with elevated privileges
If (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Warning "You need to run this script as an Administrator!"
    Pause
    Exit
}
Write-Host
Write-Host "                                        ///////////////////////////////X"
Write-Host "/IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII:::::::::: ISTANA BEC LANTAI 1 BLOK D7 :"
Write-Host ":                                         ''''''''''''''''''''''''''''':"
Write-Host ":   BB                                BB                               :"
Write-Host ":   -- BBBBBB++ BBBBBB.  BBBBBBB      -- BBBBBBBB BB     BB BBBBBBBB   :"
Write-Host ":   BB       BB BB    BB BB   BB      BB BB    BB BB     BB BB    BB   :"
Write-Host ":   BB BB    BB BB    BB BB   BB BB   BB BBBBBBBB  BB   BB  BBBBBBBB   :"
Write-Host ":   BB BB    BB BBBBBB'  BBBBBbb BBBBBBB BB    BB   d\V/b   BB    BB   :"
Write-Host ":                                                                      :"
Write-Host ":::::::::::::::::--------------------------------------:::::::::::::::::"
Write-Host "                   -- BLOCK HOSTS AUTODESK AUTOCAD --                   "
Write-Host
Write-Host
Write-Host "+ MENAMBAHKAN BLOCK HOST UNTUK AUTODESK AUTOCAD..."
Start-Sleep -seconds 10
# Daftar link Autodesk yang ingin dimasukkan ke file hosts
$links = @(
    "autodesk.fi", "autodesk.de", "autodesk.es", "autodesk.ca", "autodesk.dk", "autodesk.pl",
    "ns1.autodesk.com", "ns2.autodesk.com", "ns3.autodesk.com", "ns4.autodesk.com", "ns5.autodesk.com",
    "126114-app1.autodesk.com", "94175-app1.autodesk.com", "94184-app2.autodesk.com", "96579-lbal1.autodesk.com",
    "acamp.autodesk.com", "adeskdi3.autodesk.com", "adeskgate.autodesk.com", "adesknews2.autodesk.com",
    "adeskout.autodesk.com", "adsknateur.autodesk.com", "amernetlog.autodesk.com", "app5.autodesk.com",
    "aprimo-relay1.autodesk.com", "aprimo-relay2.autodesk.com", "aprimo-relay3.autodesk.com", "aprimo-relay4.autodesk.com",
    "autosketch.autodesk.com", "blues.autodesk.com", "cbuanprd.autodesk.com", "cbuanprhcllb.autodesk.com",
    "cbuanqa2lb.autodesk.com", "ci3dwsdev-svc.autodesk.com", "ci3dwsprd-svc.autodesk.com", "ci3dwsstg-svc.autodesk.com",
    "community.autodesk.com", "cut.autodesk.com", "cvsprd01.autodesk.com", "discussion.autodesk.com", "eur.autodesk.com",
    "extcidev.autodesk.com", "extciqa.autodesk.com", "extupg.autodesk.com", "ftp-users.autodesk.com", "ftp2b.autodesk.com",
    "gisdmzpdc.autodesk.com", "hqaribasrf04.autodesk.com", "hqmgwww01.autodesk.com", "hqmgwww04.autodesk.com",
    "hqmobileweb01.autodesk.com", "hqprxsrftrn.autodesk.com", "hqpsweb01.autodesk.com", "hubdev-svc.autodesk.com",
    "hubprd-svc.autodesk.com", "hubstg-svc.autodesk.com", "itappprd01-svc.autodesk.com", "itappprd02-svc.autodesk.com",
    "its.autodesk.com", "jdevextv-new.autodesk.com", "jp.autodesk.com", "jstgextv-new.autodesk.com", "jstgintv-new.autodesk.com",
    "lbsvzw.autodesk.com", "lbsvzw1.autodesk.com", "lbsvzw2.autodesk.com", "library.autodesk.com", "liveupdate.autodesk.com",
    "locationservices.autodesk.com", "lsctsol04.autodesk.com", "mail-relay.autodesk.com", "mneprdext-svc.autodesk.com",
    "mut.autodesk.com", "nbugma-dmz.autodesk.com", "nut.autodesk.com", "otw-new.autodesk.com", "otwdownloads.autodesk.com",
    "partnercenter.autodesk.com", "partnerproducts.autodesk.com", "paste.autodesk.com", "pedidrq.autodesk.com", "pediqrx.autodesk.com",
    "petars1.autodesk.com", "petcp11ia-2nat.autodesk.com", "petcr12ihsrp2.autodesk.com", "phxgciv.autodesk.com", "phxgciv_dr.autodesk.com",
    "planix3d.autodesk.com", "pointa.autodesk.com", "register.autodesk.com", "registerallied-pr.autodesk.com", "registeronce.autodesk.com",
    "salestraining.autodesk.com", "searchnews.autodesk.com", "shop.autodesk.com", "spamster-bulk.autodesk.com", "sswwwp.autodesk.com",
    "trialdownload.autodesk.com", "usa.autodesk.com", "uspetcr12ie_198.autodesk.com", "uspetcr12if.autodesk.com",
    "uspetcr12if_198.autodesk.com", "uspetcrs12ia_ib_vlan500_2_hsrp.autodesk.com", "uspetcrs12ia_vlan500_2.autodesk.com",
    "uspetcrs12ib_vlan500_2.autodesk.com", "uspetne06ia_ib_untrust_dip7.autodesk.com", "usrelay.autodesk.com",
    "ussclout1.autodesk.com", "vzwlpsrel.autodesk.com", "vzwlpstst.autodesk.com", "web.autodesk.com", "webservices.autodesk.com",
    "wormhole.autodesk.com", "www3.autodesk.com", "www.autodesk.com", "genuine-software.autodesk.com", "genuine-software1.autodesk.com",
    "genuine-software2.autodesk.com"
)

# Path ke file hosts
$hostsFile = "C:\Windows\System32\drivers\etc\hosts"

# Ensure the hosts file is not read-only
if ((Get-Item -Path $hostsFile).IsReadOnly) {
    (Get-Item -Path $hostsFile).IsReadOnly = $false
}

# Read the current content of the hosts file
$hostsContent = Get-Content -Path $hostsFile

# Add new entries to the hosts content
foreach ($link in $links) {
    $entry = "127.0.0.1 $link"
    if ($hostsContent -notcontains $entry) {
        Write-Host "+ Menambahkan: $entry"
        $hostsContent += $entry
    } else {
        Write-Host "Sudah ada: $entry"
    }
}

# Write the modified content back to the hosts file
try {
    Set-Content -Path $hostsFile -Value $hostsContent -Force | Out-Null
    Write-Host
    Write-Host "+ FlushDNS.."
    ipconfig /flushdns

    # Tampilkan pesan berhasil
    Write-Host
    Write-Host "Link telah ditambahkan ke file hosts dan cache.." -Foreground Green
} catch {
    Write-Error "Terjadi kesalahan: $_"
}
Write-Host
Pause
