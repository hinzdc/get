# Tentukan URL GitHub untuk file setup.exe dan configure.xml
$urlSetupExe = "https://raw.githubusercontent.com/hinzdc/get/main/setup.exe"
$urlConfigureXml = "https://raw.githubusercontent.com/hinzdc/get/main/configure.xml"

# Tentukan lokasi di mana file akan diunduh
$downloadPath = "C:\Temp"

# Unduh file setup.exe dan configure.xml
Invoke-WebRequest -Uri $urlSetupExe -OutFile "$downloadPath\setup.exe"
Invoke-WebRequest -Uri $urlConfigureXml -OutFile "$downloadPath\configure.xml"

# Cek apakah kedua file telah berhasil diunduh
if ((Test-Path "$downloadPath\setup.exe") -and (Test-Path "$downloadPath\configure.xml")) {
    Write-Host "File berhasil diunduh."
    
    # Eksekusi setup.exe dengan menggunakan konfigurasi dari configure.xml
    Start-Process -FilePath "$downloadPath\setup.exe" -ArgumentList "/config $downloadPath\configure.xml" -Wait
    
    # Cek apakah instalasi Microsoft Office telah selesai
    $officeInstalled = Get-WmiObject -Query "SELECT * FROM Win32_Product WHERE Name LIKE '%Microsoft Office%'" | Select-Object -First 1
    if ($officeInstalled) {
        Write-Host "Microsoft Office telah diinstal."
        
        # Eksekusi perintah setelah instalasi Microsoft Office selesai
        iex(irm hinzdc.xyz/get/activeauto)
    } else {
        Write-Host "Instalasi Microsoft Office gagal."
    }
} else {
    Write-Host "Gagal mengunduh file."
}
