if (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) { Start-Process powershell.exe "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs; exit }

cls
winget settings --enable InstallerHashOverride
$appxApps = @(
  "mcmilk.7zip-zstd",
  "NSIS.NSIS",
  "Google.Chrome",
  "AIMP.AIMP",
  "AngusJohnson.ResourceHacker",
  "AutoIt.AutoIt",
  "PuTTY.PuTTY",
  "Famatech.AdvancedIPScanner",
  "RARLab.WinRAR",
  "SoftDeluxe.FreeDownloadManager",
  "RamenSoftware.Windhawk",
  "Discord.Discord",
  "Telegram.TelegramDesktop",
  "WhatsApp.WhatsApp",
  "Microsoft.PowerToys",
  "Microsoft.VisualStudio.2022.Community",
  "Notepad++.Notepad++",
  "GitHub.GitHubDesktop"

)
# Loop melalui daftar aplikasi dan hapus mereka satu per satu
foreach ($app in $appxApps) {
    Write-Host "Menginstall Aplikasi: $app"
    winget install -e --id $app -h --force --accept-package-agreements --accept-source-agreements --source winget
}
winget install --id=Microsoft.VisualStudioCode -e --scope "machine"
# Menampilkan pesan setelah selesai
winget upgrade --all
Write-Host "---------------------------------------------"
Write-Host -fore green "Proses Instal aplikasi selesai."
exit
